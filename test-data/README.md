# GENEVE Test PCAP Files

This directory contains test PCAP files used to validate the GENEVE analyzer's support for different packet capture formats.

## Files

### `ethernet-test.pcap`
- **Format**: Standard Ethernet (DLT_EN10MB)
- **Contents**: 3 GENEVE packets with various vendor telemetry options
- **Use Case**: Simulates captures from specific network interfaces
- **Creation**: `tcpdump -i eth0 -w ethernet-capture.pcap`

### `cooked-test.pcap`
- **Format**: Linux cooked capture (DLT_LINUX_SLL)  
- **Contents**: Same 3 GENEVE packets as above, but in SLL format
- **Use Case**: Simulates captures from multiple interfaces simultaneously
- **Creation**: `tcpdump -i any -w cooked-capture.pcap`

## Test Packets

Each PCAP file contains 3 synthetic GENEVE packets:

1. **Packet 1**: VNI 12345 with VMware-like telemetry option
2. **Packet 2**: VNI 67890 with Cisco-like telemetry option  
3. **Packet 3**: VNI 11111 with multiple vendor options:
   - NVIDIA/Mellanox Spectrum ASIC telemetry
   - Cumulus Networks MLAG status

## Testing Commands

```bash
# Test Ethernet format detection
./build/geneve-analyzer -pcap-file test-data/ethernet-test.pcap -verbose

# Test Linux cooked format detection  
./build/geneve-analyzer -pcap-file test-data/cooked-test.pcap -verbose

# Compare outputs side by side
./build/geneve-analyzer -pcap-file test-data/ethernet-test.pcap -output summary
./build/geneve-analyzer -pcap-file test-data/cooked-test.pcap -output summary

# Test enterprise telemetry parsing
./build/geneve-analyzer -pcap-file test-data/cooked-test.pcap -enterprise

# Test JSON output
./build/geneve-analyzer -pcap-file test-data/ethernet-test.pcap -output json
```

## Expected Output Differences

### Link Type Detection
- **Ethernet**: `Link type: Ethernet`
- **Linux SLL**: `Link type: Linux cooked capture (SLL)`

### Layer Structure (Verbose Mode)
- **Ethernet**: `DEBUG: Packet 1 layers: Ethernet IPv4 UDP Geneve ...`
- **Linux SLL**: `DEBUG: Packet 1 layers: Linux SLL IPv4 UDP Geneve ...`

### Parsing Results
Both formats should produce identical GENEVE parsing results, demonstrating that the analyzer correctly handles the different link layer formats while maintaining consistent upper-layer protocol parsing.

## Validation

Run the comprehensive validation script:
```bash
./scripts/validate-pcap-support.sh
```

This script verifies:
- ✅ Correct format detection for both types
- ✅ Consistent packet parsing results  
- ✅ Enterprise telemetry extraction
- ✅ All output formats (detailed, summary, JSON)
- ✅ Performance stability

## File Generation

These test files are generated by:
```bash
./build/create-test-pcap test-data/ethernet-test.pcap test-data/cooked-test.pcap
```

The generator creates synthetic but valid GENEVE packets in both Ethernet and Linux SLL formats, allowing comprehensive testing of the analyzer's format support without requiring real network traffic.